{% extends 'base.html' %}

{% block title %}
최근 30일 카테고리 분석
{% endblock %}

{% block content %}

<div class="container-fluid">
    <nav id="Trend-sidebarMenu" class="col-md-3 d-md-block bg-light sidebar collapse">
      <div class="position-sticky pt-3">
          <ul class="three-column-side nav nav-pills justify-content-center">
            <li class="nav-item">
              <a class="nav-link link-dark" href="/latest_trend/category">Latest</a>
            </li>
            <li class="nav-item">
              <a class="nav-link link-dark" href="/15day_trend/category">15 Days</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="/30day_trend/category" aria-current="page">30 Days</a>
            </li>
          </ul>
        <ul class="nav nav-pills flex-column mb-auto">
          <li class="nav-item">
            <a href="/30day_trend/category" class="nav-link active" aria-current="page">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi me-2 bi-grid-3x3-gap" viewBox="0 0 16 16">
                    <path d="M4 2v2H2V2h2zm1 12v-2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V7a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm5 10v-2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V7a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zM9 2v2H7V2h2zm5 0v2h-2V2h2zM4 7v2H2V7h2zm5 0v2H7V7h2zm5 0h-2v2h2V7zM4 12v2H2v-2h2zm5 0v2H7v-2h2zm5 0v2h-2v-2h2zM12 1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zm-1 6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V7zm1 4a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2z"/>
                </svg>
                Category
            </a>
          </li>
          <li>
            <a href="/30day_trend/channel" class="nav-link link-dark">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi me-2 bi-collection-play" viewBox="0 0 16 16">
                  <path d="M2 3a.5.5 0 0 0 .5.5h11a.5.5 0 0 0 0-1h-11A.5.5 0 0 0 2 3zm2-2a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7A.5.5 0 0 0 4 1zm2.765 5.576A.5.5 0 0 0 6 7v5a.5.5 0 0 0 .765.424l4-2.5a.5.5 0 0 0 0-.848l-4-2.5z"/>
                  <path d="M1.5 14.5A1.5 1.5 0 0 1 0 13V6a1.5 1.5 0 0 1 1.5-1.5h13A1.5 1.5 0 0 1 16 6v7a1.5 1.5 0 0 1-1.5 1.5h-13zm13-1a.5.5 0 0 0 .5-.5V6a.5.5 0 0 0-.5-.5h-13A.5.5 0 0 0 1 6v7a.5.5 0 0 0 .5.5h13z"/>
                </svg>
                Channel
            </a>
          </li>
          <li>
            <a href="/30day_trend/timeframe" class="nav-link link-dark">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi me-2 bi-bar-chart" viewBox="0 0 16 16">
                    <path d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5v12h-2V2h2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"/>
                </svg>
                TimeFrame
            </a>
          </li>
        </ul>
      </div>
    </nav>
</div>

<!-- Basic Information -->
<div class="chart-upper-row row">
    <div class="row d-sm-flex alight-items-center justify-content-between mb-4">
        <h1 class="general-font h3 mb-1">Trend Dashboard</h1>
        <div class="general-font ms-1 text-muted">인기차트<30일> 카테고리</div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-001 shadow h-100 py-2">
            <div class="card-body">
                <div class="card-demographic row align-items-center">
                    <div class="col mr-2">
                        <div class="card-text-001 text_xs font-weight-bold mb-1">
                            VIDEO COUNTS (30DAYS)
                        </div>
                        <div class="card-demographic-text h5 mb-0 font-weight-bold">
                            {{ count_db }}
                        </div>
                    </div>
                    <div class="col-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-clipboard-data" viewBox="0 0 16 16">
                          <path d="M4 11a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0v-1zm6-4a1 1 0 1 1 2 0v5a1 1 0 1 1-2 0V7zM7 9a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V9z"/>
                          <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                          <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-002 shadow h-100 py-2">
            <div class="card-body">
                <div class="card-demographic row align-items-center">
                    <div class="col mr-2">
                        <div class="card-text-002 text_xs font-weight-bold mb-1">
                            TOP VIEW CHANNEL (30DAYS)
                        </div>
                        <div class="card-demographic-text h5 mb-0 font-weight-bold">
                            {{ category_top_channel }}
                        </div>
                    </div>
                    <div class="col-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-play-btn" viewBox="0 0 16 16">
                          <path d="M6.79 5.093A.5.5 0 0 0 6 5.5v5a.5.5 0 0 0 .79.407l3.5-2.5a.5.5 0 0 0 0-.814l-3.5-2.5z"/>
                          <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm15 0a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-003 shadow h-100 py-2">
            <div class="card-body">
                <div class="card-demographic row align-items-center">
                    <div class="col mr-2">
                        <div class="card-text-003 text_xs font-weight-bold mb-1">
                            TOP VIEW CATEGORY (30DAYS)
                        </div>
                        <div class="card-demographic-text h5 mb-0 font-weight-bold">
                            {{ category_top_category }}
                        </div>
                    </div>
                    <div class="col-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="category-bi-grid-3x3-gap bi bi-grid-3x3-gap" viewBox="0 0 16 16">
                          <path d="M4 2v2H2V2h2zm1 12v-2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V7a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm5 10v-2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V7a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zM9 2v2H7V2h2zm5 0v2h-2V2h2zM4 7v2H2V7h2zm5 0v2H7V7h2zm5 0h-2v2h2V7zM4 12v2H2v-2h2zm5 0v2H7v-2h2zm5 0v2h-2v-2h2zM12 1a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zm-1 6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V7zm1 4a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-2z"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card border-left-004 shadow h-100 py-2">
            <div class="card-body">
                <div class="card-demographic row align-items-center">
                    <div class="col mr-2">
                        <div class="card-text-004 text_xs font-weight-bold mb-1">
                            TOP COMMENTS (30DAYS)
                        </div>
                        <div class="card-demographic-text h5 mb-0 font-weight-bold">
                            {{ category_top_comment }}
                        </div>
                    </div>
                    <div class="col-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-keyboard" viewBox="0 0 16 16">
                          <path d="M14 5a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h12zM2 4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H2z"/>
                          <path d="M13 10.25a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25v-.5zm0-2a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25v-.5zm-5 0A.25.25 0 0 1 8.25 8h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5A.25.25 0 0 1 8 8.75v-.5zm2 0a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-.5zm1 2a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25v-.5zm-5-2A.25.25 0 0 1 6.25 8h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5A.25.25 0 0 1 6 8.75v-.5zm-2 0A.25.25 0 0 1 4.25 8h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5A.25.25 0 0 1 4 8.75v-.5zm-2 0A.25.25 0 0 1 2.25 8h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5A.25.25 0 0 1 2 8.75v-.5zm11-2a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25v-.5zm-2 0a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25v-.5zm-2 0A.25.25 0 0 1 9.25 6h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5A.25.25 0 0 1 9 6.75v-.5zm-2 0A.25.25 0 0 1 7.25 6h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5A.25.25 0 0 1 7 6.75v-.5zm-2 0A.25.25 0 0 1 5.25 6h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5A.25.25 0 0 1 5 6.75v-.5zm-3 0A.25.25 0 0 1 2.25 6h1.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-1.5A.25.25 0 0 1 2 6.75v-.5zm0 4a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25v-.5zm2 0a.25.25 0 0 1 .25-.25h5.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-5.5a.25.25 0 0 1-.25-.25v-.5z"/>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Information -->
<div class="chart-row row">
    <div class="chart-left col-7 d-flex flex-column">
        <!-- Left Chart -->
        <div class="card-manual-line flex-grow card-body rounded-3 border-3 shadow">
            <canvas class="my-4" id="category-chart1"></canvas>
                <script>
                    var ctx = document.getElementById("category-chart1");
                    var myChart = new Chart(ctx, {
                      type: 'bar',
                      data: {
                        datasets: [{
                            label: '조회수(%)',
                            data: {{ category_view_per | safe }},
                            borderWidth: 2,
                            backgroundColor: "rgb(241, 148, 138)"
                        },
                        {
                            label: '좋아요수(%)',
                            data: {{ category_like_per | safe }},
                            borderWidth: 2,
                            backgroundColor: "rgb(133, 193, 233)"
                        },
                        {
                            label: '댓글수(%)',
                            data: {{ category_comment_per | safe }},
                            borderWidth: 2,
                            backgroundColor: "rgb(248, 196, 113)"
                        }],
                        labels: ["엔터테인먼트", "뮤직", "푸드", "게임", "라이프스타일", "스포츠", "사회", "건강"]
                      },
                      options: {
                          legend:{
                              position: 'bottom'
                          },
                          title: {
                              display: true,
                              text: '카테고리별 수치 비율 (%)',
                              fontSize: 15
                          }
                      }
                    });
                </script>
        </div>
    </div>
    <!-- Top right chart -->
    <div class="chart-right col-4 d-flex flex-column">
        <div class="row flex-grow">
            <div class="chart-top-right card-manual-line flex-grow stretch-card rounded-3 shadow">
            <canvas class="my-4" id="category-chart2"></canvas>
                <script>
                    var chart2 = document.getElementById('category-chart2').getContext('2d');
                    var mychart1 = new Chart(chart2, {
                        type: 'doughnut',
                        data: {
                            labels: {{ category | safe }},
                            datasets: [{
                                label: '카테고리',
                                data: {{ category_rate | safe }},
                                borderWidth: 2,
                                backgroundColor: [
                                  'rgb(241, 148, 138)',
                                  'rgb(133, 193, 233)',
                                  'rgb(248, 196, 113)',
                                  'rgb(187, 143, 206)',
                                  'rgb(118, 215, 196)',
                                  'rgb(128, 139, 150)',
                                  'rgb(90, 90, 90)',
                                  'rgb(180, 180, 180)'
                                ]
                            }]
                        },
                        options: {
                            legend:{
                                position: 'bottom'
                            },
                            title: {
                                display: true,
                                text: '카테고리 수 비율 (%)',
                                fontSize: 15
                            }
                        }
                    });
                </script>
            </div>
            <!-- Bottom right chart -->
            <div class="card-manual-line flex-grow stretch-card rounded-3 shadow">
            <canvas class="my-4" id="category-chart3"></canvas>
                <script>
                    var ctx = document.getElementById("category-chart3");
                    var myChart = new Chart(ctx, {
                        type: 'horizontalBar',
                        data: {
                            datasets: [{
                                label: '조회수 (%)',
                                data: {{ category_view_per | safe }},
                                borderWidth: 2,
                                backgroundColor: [
                                    'rgb(128, 139, 150)',
                                    'rgb(128, 139, 150)',
                                    'rgb(128, 139, 150)',
                                    'rgb(128, 139, 150)',
                                    'rgb(128, 139, 150)',
                                    'rgb(128, 139, 150)',
                                    'rgb(128, 139, 150)',
                                    'rgb(128, 139, 150)'
                                ],
                                hoverBackgroundColor: [
                                  'rgb(248, 196, 113)',
                                  'rgb(248, 196, 113)',
                                  'rgb(248, 196, 113)',
                                  'rgb(248, 196, 113)',
                                  'rgb(248, 196, 113)',
                                  'rgb(248, 196, 113)',
                                  'rgb(248, 196, 113)',
                                  'rgb(248, 196, 113)'
                                ]
                            }],
                            labels: ["엔터테인먼트", "뮤직", "푸드", "게임", "라이프스타일", "스포츠", "사회", "건강"]
                        },
                        options: {
                            barPercentage: 1.0,
                            categoryPercentage: 1.0,
                            title: {
                                display: true,
                                text: '카테고리별 조회수 (%)',
                                fontSize: 15
                            },
                            legend: {
                                display: false,
                            }
                        }
                    });
                </script>
            </div>
        </div>
    </div>
</div>
<!-- Latest trend table -->
<div class="trend-category-table">
    <div class="row d-sm-flex alight-items-center justify-content-between mb-4">
        <h1 class="general-font h3 mb-1">Table</h1>
        <div class="general-font ms-1 text-muted">인기차트<30일> 카테고리별 채널합계</div>
    </div>
    <table id="table" class="table table-bordered table-hover align-middle mx-auto">
      <thead class="table-light" style="text-align:center">
        <tr>
            <th scope="col"></th>
            {% for col in category_channel.columns %}
                <th scope="col">{{col}}</th>
            {% endfor %}
        </tr>
      </thead>

      <tbody>
            {% for i in category_channel.index %}        <! -- for tag start -->
            <tr>
                <th style="text-align:center">{{ i }}</th>
                <td style="text-align:center">{{ category_channel['카테고리'][i] }}</td>
                <td style="text-align:center">{{ category_channel['채널명'][i] }}</td>
                <td style="text-align:center">{{ category_channel['조회수'][i] }}</td>
                <td style="text-align:center">{{ category_channel['좋아요수'][i] }}</td>
                <td style="text-align:center">{{ category_channel['댓글수'][i] }}</td>
            </tr>
            {% endfor %}                          <! -- for tag end -->
      </tbody>
    </table>
</div>
{% endblock %}


{% block scripts %}
  <script>
    $(document).ready(function () {
      $('#table').DataTable({
        columns: [
          {searchable: false},
          {orderable: false},
          {orderable: false},
          {searchable: false},
          {searchable: false},
          {searchable: false}]
      });
    });
  </script>
{% endblock %}